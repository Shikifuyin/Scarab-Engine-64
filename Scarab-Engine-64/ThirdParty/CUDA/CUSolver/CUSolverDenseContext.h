/////////////////////////////////////////////////////////////////////////////////
// File : ThirdParty/CUDA/CUSolver/CUSolverDenseContext.h
/////////////////////////////////////////////////////////////////////////////////
// Version : 0.1
// Status : Alpha
/////////////////////////////////////////////////////////////////////////////////
// Description : CUDA Solver Context for Dense systems
/////////////////////////////////////////////////////////////////////////////////
// Part of Scarab-Engine, licensed under the
// Creative Commons Attribution-NonCommercial-NoDerivs 3.0 Unported License
//   http://creativecommons.org/licenses/by-nc-nd/3.0/
/////////////////////////////////////////////////////////////////////////////////

/////////////////////////////////////////////////////////////////////////////////
// Known Bugs : None
// Usage : Users should create one CUSolverDenseContext in each calling thread.
//         CUSolverDenseContext lifetime should match its thread's lifetime.
/////////////////////////////////////////////////////////////////////////////////

/////////////////////////////////////////////////////////////////////////////////
// Header prelude
#ifndef SCARAB_THIRDPARTY_CUDA_CUSOLVER_CUSOLVERDENSECONTEXT_H
#define SCARAB_THIRDPARTY_CUDA_CUSOLVER_CUSOLVERDENSECONTEXT_H

/////////////////////////////////////////////////////////////////////////////////
// Includes
#include "../BLAS/CUBLASContext.h"

/////////////////////////////////////////////////////////////////////////////////
// Constants definitions

/////////////////////////////////////////////////////////////////////////////////
// The CUSolverDenseContext class
class CUSolverDenseContext
{
public:
	CUSolverDenseContext();
    ~CUSolverDenseContext();
	
	// Deferred Creation/Destruction ////////////////////////////////////////////
	inline Bool IsCreated() const;
	Void Create();
	Void Destroy(); // Warning : Triggers Synchronization on current Device, use properly !
	
	// Stream Association ///////////////////////////////////////////////////////
		// Can pass NULL to use default stream again
	Void SetStream( CUDAStream * pStream ) const;


private:
	friend class CUSolverDenseEigenValue;

	Void * m_hContext;
};

/////////////////////////////////////////////////////////////////////////////////
// Backward Includes (Inlines & Templates)
#include "CUSolverDenseContext.inl"

/////////////////////////////////////////////////////////////////////////////////
// Header end
#endif // SCARAB_THIRDPARTY_CUDA_CUSOLVER_CUSOLVERDENSECONTEXT_H
